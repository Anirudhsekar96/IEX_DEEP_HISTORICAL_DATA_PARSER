#include <gtest/gtest.h>
#include <string>
#include "../src/utils/decode.cpp"

TEST(SYSTEM_EVENT_MESSAGE, SYSTEM_EVENT_MESSAGE)
{
    std::string result = MessageType::system_event_message("534500a09997e93db614");
    const char *input = result.c_str();
    const char *output = "1492448400000000000,END_OF_SYSTEM_HOURS\n";
    EXPECT_STRCASEEQ(input, output);
}

TEST(SECURITY_DIRECTORY_MESSAGE, SECURITY_DIRECTORY_MESSAGE)
{
    std::string result = MessageType::security_directory("44800020897b5a1fb6145a4945585420202064000000241d0f000000000001");
    const char *input = result.c_str();
    const char *output = "ZIEXT,1492414800000000000,TIER_1_NMS_STOCK,990500,100,TEST_SECURITY,NOT_WHEN_ISSUED_SECURITY,NOT_EXCHANGE_TRADED_PRODUCT\n";
    EXPECT_STRCASEEQ(input, output);
}

TEST(TRADING_STATUS_MESSAGE, TRADING_STATUS_MESSAGE)
{
    std::string result = MessageType::trading_status("4848ac63c02096866d145a4945585420202054312020");
    const char *input = result.c_str();
    const char *output = "ZIEXT,1471980632572715948,TRADING_HALTED_ACCROSS_ALL_US_EQUITY_MARKETS,HALT_NEWS_PENDING\n";
    EXPECT_STRCASEEQ(input, output);
}

TEST(OPERATIONAL_HALT_STATUS, OPERATIONAL_HALT_STATUS)
{
    std::string result = MessageType::operational_halt_status("4f4fac63c02096866d145a49455854202020");
    const char *input = result.c_str();
    const char *output = "ZIEXT,1471980632572715948,IEX_SPECIFIED_OPERATIONAL_HALT\n";
    EXPECT_STRCASEEQ(input, output);
}

TEST(SHORT_SALE_PRICE_TEST_STATUS, SHORT_SALE_PRICE_TEST_STATUS)
{
    std::string result = MessageType::short_sale_price_test("5001ac63c02096866d145a4945585420202041");
    const char *input = result.c_str();
    const char *output = "ZIEXT,1471980632572715948,SHORT_SALE_PRICE_TEST_IN_EFFECT,SHORT_SALE_PRICE_RESTRICTION_ACTIVATED\n";
    EXPECT_STRCASEEQ(input, output);
}

TEST(SECURITY_EVENT_MESSAGE, SECURITY_EVENT_MESSAGE)
{
    std::string result = MessageType::security_event("454f00f0302a5b25b6145a49455854202020");
    const char *input = result.c_str();
    const char *output = "ZIEXT,1492421400000000000,OPENING_PROCESS_COMPLETED\n";
    EXPECT_STRCASEEQ(input, output);
}

TEST(PRICE_LEVEL_UPDATE, PRICE_LEVEL_UPDATE)
{
    std::string result = MessageType::price_level_update("3801ac63c02096866d145a49455854202020e4250000241d0f0000000000");
    const char *input = result.c_str();
    const char *output = "ZIEXT,1471980632572715948,990500,9700,ORDER_BOOK_EVENT_PROCESSING_COMPLETED\n";
    EXPECT_STRCASEEQ(input, output);
}

TEST(TRADE_REPORT_MESSAGE, TRADE_REPORT_MESSAGE)
{
    std::string result = MessageType::trade_report("5400c3dff705a2866d145a4945585420202064000000241d0f0000000000968f060000000000");
    const char *input = result.c_str();
    const char *output = "ZIEXT,1471980683662974915,990500,100,429974,NON_INTERMARKET_SWEEP,REGULAR_MARKET_TRADE_SESSION,ROUND_OR_MIXED_LOT_TRADE,TRADE_IS_SUBJECT_TO_RULE611_SEC_TRADE_THROUGH,EXECUTION_DURING_CONTINOUS_TRADING,LAST_SALE_ELIGIBLE,HIGH_LOW_PRICE_ELIGIBLE,VOLUME_ELIGIBLE\n";
    EXPECT_STRCASEEQ(input, output);
}

TEST(OFFICIAL_PRICE, OFFICIAL_PRICE)
{
    std::string result = MessageType::official_price("585100f0302a5b25b6145a49455854202020241d0f0000000000");
    const char *input = result.c_str();
    const char *output = "ZIEXT,1492421400000000000,990500,IEX_OFFICIAL_OPENING_PRICE\n";
    EXPECT_STRCASEEQ(input, output);
}

TEST(TRADE_BREAK, TRADE_BREAK)
{
    std::string result = MessageType::trade_break_message("4200b28fa5a0ab866d145a4945585420202064000000241d0f0000000000968f060000000000");
    const char *input = result.c_str();
    const char *output = "ZIEXT,1471980724912754610,990500,100,NON_INTERMARKET_SWEEP,REGULAR_MARKET_TRADE_SESSION,ROUND_OR_MIXED_LOT_TRADE,TRADE_IS_SUBJECT_TO_RULE611_SEC_TRADE_THROUGH,EXECUTION_DURING_CONTINOUS_TRADING,LAST_SALE_ELIGIBLE,HIGH_LOW_PRICE_ELIGIBLE,VOLUME_ELIGIBLE,429974\n";
    EXPECT_STRCASEEQ(input, output);
}

TEST(AUCTION_MESSAGE, AUCTION_MESSAGE)
{
    std::string result = MessageType::auction_message("4143ddc7f09a1a3ab6145a49455854202020186a0000241d0f0000000000181f0f000000000027100000420080e6f4580c210f0000000000c01c0f0000000000a4990d0000000000dc9f100000000000");
    const char *input = result.c_str();
    const char *output = "ZIEXT,1492444212462929885,CLOSING_AUCTION,27160,990500,991000,4135,BUY_SIDE_IMBALANCE,0,1492444800,991500,990400,891300,1089500\n";
    EXPECT_STRCASEEQ(input, output);
}